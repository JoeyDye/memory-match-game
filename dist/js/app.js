"use strict";var deck=document.querySelector(".deck"),cards=deck.children,rating=document.querySelector(".score__stars"),stars=rating.children,moves=document.querySelector(".score__moves"),modal=document.querySelector(".modal-body"),timer=document.querySelector("#timer"),reset=document.querySelector(".score__restart"),playAgain=document.querySelector(".play-again"),win=!1,time=void 0,isTimerOn=!1,timerVar=void 0,totalSeconds=0,star=void 0,starCount=3,score=0,moveCount=0,clicked=void 0,newCards=[],firstCard=void 0,firstCardClass=void 0,secondCard=void 0,secondCardClass=void 0,startTimer=function(){timerVar=setInterval(countTimer,1e3)},countTimer=function(){++totalSeconds;var r=Math.floor(totalSeconds/60),e=totalSeconds-60*r;r<10&&(r="0"+r),e<10&&(e="0"+e),time=timer.innerHTML=r+":"+e},stopTimer=function(){clearInterval(timerVar)},shuffle=function(r){var e=0,t=0,a=null;for(e=r.length-1;0<e;e-=1)t=Math.floor(Math.random()*(e+1)),a=r[e],r[e]=r[t],r[t]=a},shuffleCards=function(){var r=!0,e=!1,t=void 0;try{for(var a,s=cards[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value.innerHTML;newCards.push(c)}}catch(r){e=!0,t=r}finally{try{!r&&s.return&&s.return()}finally{if(e)throw t}}shuffle(newCards);for(var n=0;n<16;n++)cards[n].innerHTML=newCards[n]},getTime=function(){return timer.innerText},resetGame=function(){newCards=[],shuffleCards();var r=!0,e=!1,t=void 0;try{for(var a,s=cards[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.classList.remove("deck__card--open","deck__card--show","deck__card--match")}}catch(r){e=!0,t=r}finally{try{!r&&s.return&&s.return()}finally{if(e)throw t}}moveCount=0,moves.innerText=moveCount,stopTimer();var c=!(isTimerOn=!1),n=!(timer.innerHTML="00:00"),o=void 0;try{for(var i,d=stars[Symbol.iterator]();!(c=(i=d.next()).done);c=!0){var l=i.value;l.removeChild(l.firstChild)}}catch(r){n=!0,o=r}finally{try{!c&&d.return&&d.return()}finally{if(n)throw o}}var m=!0,f=!1,u=void 0;try{for(var v,h=stars[Symbol.iterator]();!(m=(v=h.next()).done);m=!0){v.value.innerHTML='<i class="fas fa-star"></i>'}}catch(r){f=!0,u=r}finally{try{!m&&h.return&&h.return()}finally{if(f)throw u}}starCount=3,score=0,$("#success-modal").modal("hide"),clicked=!1},starRating=function(){switch(moveCount++,moves.innerText=moveCount){case 15:(star=stars[2].firstElementChild).remove(),stars[2].innerHTML='<i class="far fa-star"></i>',starCount--;break;case 20:(star=stars[1].firstElementChild).remove(),stars[1].innerHTML='<i class="far fa-star"></i>',starCount--}},showCard=function(r){r.classList.add("deck__card--open","deck__card--show")},correctMatch=function(r,e){r.classList.add("deck__card--match"),e.classList.add("deck__card--show","deck__card--match"),clicked=!1,7<++score&&(win=!0,stopTimer(),time=getTime(),modal.innerHTML="<p><strong>Time:</strong> "+time+"</p><p><strong>Stars:</strong> "+starCount+"</p><p><strong>Moves:</strong> "+moveCount+"</p>",$("#success-modal").modal("show"))},incorrectMatch=function(r,e){r.classList.add("deck__card--fail"),r.classList.remove("deck__card--open"),e.classList.add("deck__card--show","deck__card--fail"),setTimeout(function(){r.classList.remove("deck__card--fail","deck__card--show"),e.classList.remove("deck__card--fail","deck__card--show")},500),clicked=!1},cardMatch=function(r){isTimerOn||(totalSeconds=0,startTimer(),isTimerOn=!0),"LI"===r.target.nodeName&&!0===clicked&&!1===r.target.classList.contains("deck__card--match")&&!1===r.target.classList.contains("deck__card--show")?(secondCard=r.target,secondCardClass=secondCard.children[0].classList[1],firstCardClass===secondCardClass?correctMatch(firstCard,secondCard):incorrectMatch(firstCard,secondCard),!1===win&&starRating()):"LI"===r.target.nodeName&&!1===r.target.classList.contains("deck__card--match")&&(firstCard=r.target,firstCardClass=firstCard.children[0].classList[1],showCard(firstCard),clicked=!0)};shuffleCards(),deck.addEventListener("click",cardMatch),reset.addEventListener("click",resetGame),playAgain.addEventListener("click",resetGame);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJkZWNrIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2FyZHMiLCJjaGlsZHJlbiIsInJhdGluZyIsInN0YXJzIiwibW92ZXMiLCJtb2RhbCIsInRpbWVyIiwicmVzZXQiLCJwbGF5QWdhaW4iLCJ3aW4iLCJ0aW1lIiwiaXNUaW1lck9uIiwidGltZXJWYXIiLCJ0b3RhbFNlY29uZHMiLCJzdGFyIiwic3RhckNvdW50Iiwic2NvcmUiLCJtb3ZlQ291bnQiLCJjbGlja2VkIiwibmV3Q2FyZHMiLCJmaXJzdENhcmQiLCJmaXJzdENhcmRDbGFzcyIsInNlY29uZENhcmQiLCJzdGFydFRpbWVyIiwiY291bnRUaW1lciIsIk1hdGgiLCJmbG9vciIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwiaW5uZXJIVE1MIiwic3RvcFRpbWVyIiwiY2xlYXJJbnRlcnZhbCIsInNodWZmbGUiLCJhcnJheSIsImkiLCJqIiwibGVuZ3RoIiwicmFuZG9tIiwidGVtcCIsInNodWZmbGVDYXJkcyIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwiY2FyZCIsInZhbHVlIiwicHVzaCIsImVyciIsInJldHVybiIsImdldFRpbWUiLCJpbm5lclRleHQiLCJyZXNldEdhbWUiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJmaW5pc2hUaW1lIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMiLCJfZGlkSXRlcmF0b3JFcnJvcjMiLCJfaXRlcmF0b3JFcnJvcjMiLCJ2YWwiLCJyZW1vdmVDaGlsZCIsImZpcnN0Q2hpbGQiLCJfaXRlcmF0b3IzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQiLCJfZGlkSXRlcmF0b3JFcnJvcjQiLCJfaXRlcmF0b3JFcnJvcjQiLCJfc3RlcDQiLCJfaXRlcmF0b3I0IiwiJCIsInN0YXJSYXRpbmciLCJmaXJzdEVsZW1lbnRDaGlsZCIsImFkZCIsImNvcnJlY3RNYXRjaCIsImNhcmQxIiwiY2FyZDIiLCJzZXRUaW1lb3V0IiwiY2FyZE1hdGNoIiwiZXZ0IiwidGFyZ2V0Iiwibm9kZU5hbWUiLCJjb250YWlucyIsInNlY29uZENhcmRDbGFzcyIsImluY29ycmVjdE1hdGNoIiwic2hvd0NhcmQiLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFNQSxLQUFPQyxTQUFTQyxjQUFjLFNBQTlCRixNQUFPQyxLQUFBQSxTQUNQRSxPQUFRSCxTQUFLSSxjQUFuQixpQkFDTUMsTUFBU0osT0FBQUEsU0FDVEssTUFBUUQsU0FBT0QsY0FBckIsaUJBQ01HLE1BQVFOLFNBQVNDLGNBQWMsZUFDL0JNLE1BQVFQLFNBQVNDLGNBQWMsVUFDL0JPLE1BQVFSLFNBQVNDLGNBQWMsbUJBQy9CUSxVQUFRVCxTQUFTQyxjQUFjLGVBQy9CUyxLQUFBQSxFQUNGQyxVQUFBQSxFQUNBQyxXQUFBQSxFQUNBQyxjQUFBQSxFQUNBQyxhQUFBQSxFQUNBQyxVQUFBQSxFQUNBQyxVQUFBQSxFQUNBQyxNQUFBQSxFQUNBQyxVQUFKLEVBQ0lDLGFBQUFBLEVBQ0FDLFNBQUFBLEdBQ0FDLGVBQUFBLEVBQ0FDLG9CQUFBQSxFQUNBQyxnQkFBQUEsRUFDQUMscUJBQUFBLEVBS0VDLFdBQWEsV0FBbkJYLFNBQU1XLFlBQWFDLFdBQUEsTUFNYkEsV0FBYSxhQUFiQSxhQUNKLElBQUVYLEVBQUZZLEtBQUFDLE1BQUFiLGFBQUEsSUFDSWMsRUFBVUYsYUFBMEIsR0FBZlosRUFHckJjLEVBQVUsS0FBZEEsRUFBQUEsSUFBQUEsR0FJSUMsRUFBVSxLQUFkQSxFQUFBQSxJQUFBQSxHQUlBbEIsS0FBT0osTUFB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c0UsY0E3Q0YsT0FBQVEsRUFBQUMsT0FBQUMsV0FBQSxJQUFBRixFQUFBQyxPQUFBekIsVUFBQTJCLFNBQUEsdUJBcUlNdEUsVUFBWW1FLEVBQUlDLE9BbEZ0Qm5FLGVBQUFELFVBQUFuQixTQUFBLEdBQUE4RCxVQUFBLEdBb0ZNOEIsU0FBU3pFLFdBQ1RGLFNBQVUsSUE1RWRxQixlQUNFMUMsS0FBQWlHLGlCQUFBLFFBQUFSLFdBQ0V4RSxNQUFBQSxpQkFBZ0JrRSxRQUFBQSxXQUNoQmxFLFVBQUFBLGlCQUFBLFFBQUEyQyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmNvbnN0IGRlY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGVjaycpO1xuY29uc3QgY2FyZHMgPSBkZWNrLmNoaWxkcmVuO1xuY29uc3QgcmF0aW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjb3JlX19zdGFycycpO1xuY29uc3Qgc3RhcnMgPSByYXRpbmcuY2hpbGRyZW47XG5jb25zdCBtb3ZlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY29yZV9fbW92ZXMnKTtcbmNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWJvZHknKTtcbmNvbnN0IHRpbWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RpbWVyJyk7XG5jb25zdCByZXNldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY29yZV9fcmVzdGFydCcpO1xuY29uc3QgcGxheUFnYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXktYWdhaW4nKTtcbmxldCB3aW4gPSBmYWxzZTtcbmxldCB0aW1lO1xubGV0IGlzVGltZXJPbiA9IGZhbHNlO1xubGV0IHRpbWVyVmFyO1xubGV0IHRvdGFsU2Vjb25kcyA9IDA7XG5sZXQgc3RhcjtcbmxldCBzdGFyQ291bnQgPSAzO1xubGV0IHNjb3JlID0gMDtcbmxldCBtb3ZlQ291bnQgPSAwO1xubGV0IGNsaWNrZWQ7XG5sZXQgbmV3Q2FyZHMgPSBbXTtcbmxldCBmaXJzdENhcmQ7XG5sZXQgZmlyc3RDYXJkQ2xhc3NcbmxldCBzZWNvbmRDYXJkO1xubGV0IHNlY29uZENhcmRDbGFzc1xuXG4vKiogQGRlc2NyaXB0aW9uIFN0YXJ0IGdhbWUgdGltZXIgKi9cblxuY29uc3Qgc3RhcnRUaW1lciA9ICgpID0+IHtcbiAgdGltZXJWYXIgPSBzZXRJbnRlcnZhbChjb3VudFRpbWVyLCAxMDAwKTtcbn1cblxuLyoqIEBkZXNjcmlwdGlvbiBDcmVhdGUgYSBjb3VudCB1cCB0aW1lciBhbmQgYWRkIHRpbWUgdG8gZGl2IGNhbGxlZCB0aW1lciAqL1xuXG5jb25zdCBjb3VudFRpbWVyID0gKCkgPT4ge1xuICArK3RvdGFsU2Vjb25kcztcbiAgbGV0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKHRvdGFsU2Vjb25kcyAvIDYwKTtcbiAgbGV0IHNlY29uZHMgPSB0b3RhbFNlY29uZHMgLSAobWludXRlcyAqIDYwKTtcblxuICBpZiAobWludXRlcyA8IDEwKSB7XG4gICAgbWludXRlcyA9IGAwJHttaW51dGVzfWA7XG4gIH1cblxuICBpZiAoc2Vjb25kcyA8IDEwKSB7XG4gICAgc2Vjb25kcyA9IGAwJHtzZWNvbmRzfWA7XG4gIH1cblxuICB0aW1lID0gdGltZXIuaW5uZXJIVE1MID0gYCR7bWludXRlc306JHtzZWNvbmRzfWA7XG59XG5cbi8qKiBAZGVzY3JpcHRpb24gU3RvcCBnYW1lIHRpbWVyICovXG5cbmNvbnN0IHN0b3BUaW1lciA9ICgpID0+IHtcbiAgY2xlYXJJbnRlcnZhbCh0aW1lclZhcik7XG59XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIFNodWZmbGUgYW4gYXJyYXkgb2YgaXRlbXNcbiAqIFJlZmVyZW5jZTogRmlzaGVyLVlhdGVzIHNodWZmbGUgZnJvbSBodHRwczovL3d3dy5mcmFua21pdGNoZWxsLm9yZy8yMDE1LzAxL2Zpc2hlci15YXRlcy8pXG4gKi9cblxuY29uc3Qgc2h1ZmZsZSA9IGFycmF5ID0+IHtcbiAgbGV0IGkgPSAwO1xuICBsZXQgaiA9IDA7XG4gIGxldCB0ZW1wID0gbnVsbDtcblxuICBmb3IgKGkgPSBhcnJheS5sZW5ndGggLSAxOyBpID4gMDsgaSAtPSAxKSB7XG4gICAgaiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChpICsgMSkpO1xuICAgIHRlbXAgPSBhcnJheVtpXTtcbiAgICBhcnJheVtpXSA9IGFycmF5W2pdO1xuICAgIGFycmF5W2pdID0gdGVtcDtcbiAgfVxufVxuXG4vKiogQGRlc2NyaXB0aW9uIFNodWZmbGUgdGhlIGRlY2sgKi9cblxuXG5jb25zdCBzaHVmZmxlQ2FyZHMgPSAoKSA9PiB7XG4gIGZvciAobGV0IHZhbCBvZiBjYXJkcykge1xuICAgIGxldCBjYXJkID0gdmFsLmlubmVySFRNTDtcbiAgICBuZXdDYXJkcy5wdXNoKGNhcmQpO1xuICB9XG5cbiAgc2h1ZmZsZShuZXdDYXJkcyk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgY2FyZHNbaV0uaW5uZXJIVE1MID0gbmV3Q2FyZHNbaV07XG4gIH1cbn1cblxuLyoqIEBkZXNjcmlwdGlvbiBSZXRyaWV2ZSBjdXJyZW50IGdhbWUgdGltZSAqL1xuXG5jb25zdCBnZXRUaW1lID0gKCkgPT4ge1xuICBsZXQgZmluaXNoVGltZSA9IHRpbWVyLmlubmVyVGV4dDtcbiAgcmV0dXJuIGZpbmlzaFRpbWU7XG59XG5cbi8qKiBAZGVzY3JpcHRpb24gUmVzZXQgZ2FtZSAqL1xuXG5jb25zdCByZXNldEdhbWUgPSAoKSA9PiB7XG5cbiAgLyoqIFJlc2h1ZmZsZSBkZWNrICovXG5cbiAgbmV3Q2FyZHMgPSBbXTtcblxuICBzaHVmZmxlQ2FyZHMoKTtcblxuICAvKiogRmxpcCBjYXJkcyBmYWNlIGRvd24gKi9cblxuICBmb3IgKGxldCB2YWx1ZSBvZiBjYXJkcykge1xuICAgIHZhbHVlLmNsYXNzTGlzdC5yZW1vdmUoJ2RlY2tfX2NhcmQtLW9wZW4nLCAnZGVja19fY2FyZC0tc2hvdycsICdkZWNrX19jYXJkLS1tYXRjaCcpO1xuICB9XG5cbiAgLyoqIFNldCBtb3ZlIGNvdW50IGJhY2sgdG8gMCAqL1xuXG4gIG1vdmVDb3VudCA9IDA7XG4gIG1vdmVzLmlubmVyVGV4dCA9IG1vdmVDb3VudDtcblxuICAvKiogU3RvcCBnYW1lIHRpbWVyICovXG5cbiAgc3RvcFRpbWVyKCk7XG4gIGlzVGltZXJPbiA9IGZhbHNlO1xuICB0aW1lci5pbm5lckhUTUwgPSBgMDA6MDBgO1xuXG4gIC8qKiBTZXQgc3RhciB0b3RhbCBiYWNrIHRvIDMgKi9cblxuICBmb3IgKGxldCB2YWwgb2Ygc3RhcnMpIHtcbiAgICB2YWwucmVtb3ZlQ2hpbGQodmFsLmZpcnN0Q2hpbGQpO1xuICB9XG5cbiAgZm9yIChsZXQgdmFsIG9mIHN0YXJzKSB7XG4gICAgdmFsLmlubmVySFRNTCA9ICc8aSBjbGFzcz1cImZhcyBmYS1zdGFyXCI+PC9pPic7XG4gIH1cblxuICBzdGFyQ291bnQgPSAzO1xuXG4gIC8qKiBTZXQgc2NvcmUgYmFjayB0byAwICovXG5cbiAgc2NvcmUgPSAwO1xuXG4gIC8qKiBIaWRlIHN1Y2Nlc3MgbW9kYWwgKi9cblxuICAkKCcjc3VjY2Vzcy1tb2RhbCcpLm1vZGFsKCdoaWRlJyk7XG5cbiAgLyoqIFNldCBjbGljayB2YWx1ZSBiYWNrIHRvIGZhbHNlICovXG5cbiAgY2xpY2tlZCA9IGZhbHNlO1xuXG59XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIEtlZXAgdHJhY2sgb2YgZ2FtZSBtb3ZlcyBhbmQgcmVkdWNlIHN0YXIgY291bnQgYmFzZWQgb24gc3BlY2lmaWVkIG51bWJlciBvZiBtb3Zlcy5cbiAqIFN3aXRjaCBwcm92aWRlcyBhIHNpbXBsZSBzb2x1dGlvbiBmb3IgZXZhbHVhdGluZyB0aGUgc3RhciBjb3VudCBhbmQgbWFrZXMgaXQgZWFzeSB0byBjaGFuZ2Ugc3RhciByYXRpbmcgY29uZGl0aW9ucyBiYXNlZCBvbiBwbGF5ZXIgZmVlZGJhY2tcbiAqL1xuXG5jb25zdCBzdGFyUmF0aW5nID0gKCkgPT4ge1xuICBtb3ZlQ291bnQrKztcbiAgbW92ZXMuaW5uZXJUZXh0ID0gbW92ZUNvdW50O1xuXG4gIHN3aXRjaCAobW92ZUNvdW50KSB7XG4gICAgY2FzZSAxNTpcbiAgICAgIHN0YXIgPSBzdGFyc1syXS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgIHN0YXIucmVtb3ZlKCk7XG4gICAgICBzdGFyc1syXS5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJmYXIgZmEtc3RhclwiPjwvaT4nO1xuICAgICAgc3RhckNvdW50LS07XG4gICAgICBicmVhaztcbiAgICBjYXNlIDIwOlxuICAgICAgc3RhciA9IHN0YXJzWzFdLmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgc3Rhci5yZW1vdmUoKTtcbiAgICAgIHN0YXJzWzFdLmlubmVySFRNTCA9ICc8aSBjbGFzcz1cImZhciBmYS1zdGFyXCI+PC9pPidcbiAgICAgIHN0YXJDb3VudC0tO1xuICB9XG59XG5cbi8qKiBAZGVzY3JpcHRpb24gQWRkIG9wZW4gYW5kIHNob3cgY2FyZCBtb2RpZmllciBjbGFzc2VzIHRvIGNsaWNrZWQgY2FyZHMgdG8gZW5hYmxlIGZsaXAgYW5pbWF0aW9uIGFuZCByZXZlYWwgIGNhcmQgdmFsdWUgKi9cblxuY29uc3Qgc2hvd0NhcmQgPSAoY2FyZCkgPT4ge1xuICBjYXJkLmNsYXNzTGlzdC5hZGQoJ2RlY2tfX2NhcmQtLW9wZW4nLCAnZGVja19fY2FyZC0tc2hvdycpO1xufVxuXG4vKiogQGRlc2NyaXB0aW9uIEFkZCBtYXRjaCBhbmQgc2hvdyBjYXJkIG1vZGlmaWVyIGNsYXNzZXMgdG8gY2xpY2tlZCBjYXJkcywgbGV0dGluZyBwbGF5ZXIga25vdyB0aGV5IGhhdmUgc3VjY2Vzc2Z1bGx5IG1hdGNoZWQgYSBwYWlyIG9mIGNhcmRzLiAqL1xuXG5jb25zdCBjb3JyZWN0TWF0Y2ggPSAoY2FyZDEsIGNhcmQyKSA9PiB7XG4gIGNhcmQxLmNsYXNzTGlzdC5hZGQoJ2RlY2tfX2NhcmQtLW1hdGNoJyk7XG4gIGNhcmQyLmNsYXNzTGlzdC5hZGQoJ2RlY2tfX2NhcmQtLXNob3cnLCAnZGVja19fY2FyZC0tbWF0Y2gnKTtcbiAgY2xpY2tlZCA9IGZhbHNlO1xuXG4gIC8qKiBDaGVjayB0byBzZWUgaWYgdGhlIHBsYXllciBoYXMgbWF0Y2hlZCBhbGwgY2FyZHMgaW4gdGhlIGRlY2suIElmIHRydWUsIGRpc3BsYXkgYSBtb2RhbCB3aXRoIHBsYXllciBzdGF0cyBhbmQgb3B0aW9uIHRvIHBsYXkgYWdhaW4uICovXG5cbiAgc2NvcmUrKztcbiAgaWYgKHNjb3JlID4gNykge1xuICAgIHdpbiA9IHRydWU7XG4gICAgc3RvcFRpbWVyKCk7XG4gICAgdGltZSA9IGdldFRpbWUoKTtcbiAgICBtb2RhbC5pbm5lckhUTUwgPSBgPHA+PHN0cm9uZz5UaW1lOjwvc3Ryb25nPiAke3RpbWV9PC9wPjxwPjxzdHJvbmc+U3RhcnM6PC9zdHJvbmc+ICR7c3RhckNvdW50fTwvcD48cD48c3Ryb25nPk1vdmVzOjwvc3Ryb25nPiAke21vdmVDb3VudH08L3A+YDtcbiAgICAkKCcjc3VjY2Vzcy1tb2RhbCcpLm1vZGFsKCdzaG93Jyk7XG4gIH1cbn1cblxuLyoqIEBkZXNjcmlwdGlvbiBBZGQgZmFpbCBjYXJkIG1vZGlmaWVyIGNsYXNzIHRvIGNsaWNrZWQgY2FyZHMsIGxldHRpbmcgcGxheWVyIGtub3cgdGhlIHNlbGVjdGVkIGNhcmRzIHRvIG5vdCBtYXRjaCAqL1xuXG5jb25zdCBpbmNvcnJlY3RNYXRjaCA9IChjYXJkMSwgY2FyZDIpICA9PiB7XG4gIGNhcmQxLmNsYXNzTGlzdC5hZGQoJ2RlY2tfX2NhcmQtLWZhaWwnKTtcbiAgY2FyZDEuY2xhc3NMaXN0LnJlbW92ZSgnZGVja19fY2FyZC0tb3BlbicpO1xuICBjYXJkMi5jbGFzc0xpc3QuYWRkKCdkZWNrX19jYXJkLS1zaG93JywgJ2RlY2tfX2NhcmQtLWZhaWwnKTtcblxuICAvKiogUmVtb3ZlIGZhaWwgYW5kIHNob3cgY2FyZCBtb2RpZmllciBjbGFzc2VzIGFmdGVyIDAuNSBzZWNvbmRzICovXG5cbiAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgIGNhcmQxLmNsYXNzTGlzdC5yZW1vdmUoJ2RlY2tfX2NhcmQtLWZhaWwnLCAnZGVja19fY2FyZC0tc2hvdycpO1xuICAgIGNhcmQyLmNsYXNzTGlzdC5yZW1vdmUoJ2RlY2tfX2NhcmQtLWZhaWwnLCAnZGVja19fY2FyZC0tc2hvdycpO30sIDUwMClcbiAgICBjbGlja2VkID0gZmFsc2U7XG59XG5cbi8qKiBAZGVzY3JpcHRpb24gU3RhcnQgdGltZXIuIEZvciBmaXJzdCBzZWxlY3RlZCBjYXJkLCBjYWxsIHNob3dDYXJkIGZ1bmN0aW9uIHRvIGZsaXAgY2FyZCBhbmQgcmV2ZWFsIGNhcmQgdmFsdWUuIE9uY2Ugc2Vjb25kIGNhcmQgc2VsZWN0ZWQsIHRlc3QgdG8gc2VlIGlmIGNhcmRzIGFyZSBhIGNvcnJlY3QgbWF0Y2guIFVwZGF0ZSBzdGFyIHJhdGluZyBhbmQgbW92ZXMgYWZ0ZXIgZXZlcnkgbWF0Y2ggdGVzdC4gKi9cblxuY29uc3QgY2FyZE1hdGNoID0gZXZ0ID0+IHtcbiAgaWYgKCFpc1RpbWVyT24pIHtcbiAgICB0b3RhbFNlY29uZHMgPSAwO1xuICAgIHN0YXJ0VGltZXIoKTtcbiAgICBpc1RpbWVyT24gPSB0cnVlO1xuICB9XG5cbiAgaWYgKGV2dC50YXJnZXQubm9kZU5hbWUgPT09ICdMSScgJiYgY2xpY2tlZCA9PT0gdHJ1ZSAmJiBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZGVja19fY2FyZC0tbWF0Y2gnKSA9PT0gZmFsc2UgJiYgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2RlY2tfX2NhcmQtLXNob3cnKSA9PT0gZmFsc2UpIHtcbiAgICBzZWNvbmRDYXJkID0gZXZ0LnRhcmdldDtcbiAgICBzZWNvbmRDYXJkQ2xhc3MgPSBzZWNvbmRDYXJkLmNoaWxkcmVuWzBdLmNsYXNzTGlzdFsxXTtcbiAgICBmaXJzdENhcmRDbGFzcyA9PT0gc2Vjb25kQ2FyZENsYXNzID8gY29ycmVjdE1hdGNoKGZpcnN0Q2FyZCwgc2Vjb25kQ2FyZCkgOiBpbmNvcnJlY3RNYXRjaChmaXJzdENhcmQsIHNlY29uZENhcmQpO1xuICAgIGlmICh3aW4gPT09IGZhbHNlKSB7XG4gICAgICBzdGFyUmF0aW5nKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChldnQudGFyZ2V0Lm5vZGVOYW1lID09PSAnTEknICYmIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWNrX19jYXJkLS1tYXRjaCcpID09PSBmYWxzZSkge1xuICAgICAgZmlyc3RDYXJkID0gZXZ0LnRhcmdldDtcbiAgICAgIGZpcnN0Q2FyZENsYXNzID0gZmlyc3RDYXJkLmNoaWxkcmVuWzBdLmNsYXNzTGlzdFsxXTtcbiAgICAgIHNob3dDYXJkKGZpcnN0Q2FyZCk7XG4gICAgICBjbGlja2VkID0gdHJ1ZTtcbiAgICB9XG4gICB9XG4gfVxuXG4vKiogU2h1ZmZsZSBkZWNrIGFuZCBhZGQgZXZlbnQgbGlzdGVuZXJzIHRvIGRlY2ssIHJlc2V0IGljb24sIGFuZCBwbGF5IGFnYWluIGJ1dHRvbiBvbiBsb2FkICovXG5cbnNodWZmbGVDYXJkcygpO1xuZGVjay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhcmRNYXRjaCk7XG5yZXNldC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlc2V0R2FtZSk7XG5wbGF5QWdhaW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXNldEdhbWUpOyJdfQ==
